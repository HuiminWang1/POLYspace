% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/neighborhoodEnrichment.R
\name{neighborhoodEnrichment}
\alias{neighborhoodEnrichment}
\title{Neighborhood enrichment analysis}
\usage{
neighborhoodEnrichment(
  POLYspace,
  region = TRUE,
  delimiter_node = "--",
  delimiter_region_celltype = "_",
  neighborhoods_of_interest = "default",
  permutation_times = 100,
  p_adjust_method = "fdr",
  ncores = 1,
  mc.preschedule = TRUE,
  set_seed = TRUE,
  seed = 123
)
}
\arguments{
\item{POLYspace}{A \code{POLYspace} object.}

\item{region}{Logical; whether to include region-level information when
performing canonical neighborhood annotation. This option is effective
only if region information was included in the previous annotation step.}

\item{delimiter_node}{Character; delimiter used between node labels during
annotation (default \code{"--"}).}

\item{delimiter_region_celltype}{Character; delimiter used between region and
cell type during annotation (default \code{"_"}).}

\item{neighborhoods_of_interest}{Neighborhoods to be tested for enrichment.
This can be specified as:
\itemize{
\item \code{"default"}: for complex neighborhood shapes (beyond pairs),
only neighborhoods with all distinct node types are considered;
\item \code{"full"}: all neighborhood types detected in each sample are included;
\item a user-defined list: a list whose elements correspond to targets,
where each element specifies the neighborhoods of interest for that target.
}}

\item{permutation_times}{Integer; number of permutations used for enrichment
analysis (default \code{100}).}

\item{p_adjust_method}{Character; method used for multiple testing correction
in permutation-based tests (e.g., \code{"fdr"}).}

\item{ncores}{Integer; number of CPU cores to use. This is primarily used for
permutation-based enrichment, where computations are distributed across
combinations of samples and targets, with each permutation assigned to a core.}

\item{mc.preschedule}{Logical; passed to \code{parallel::mclapply()}.}

\item{set_seed}{Logical; if \code{TRUE}, set the random number generator seed
to \code{seed} for reproducibility.}

\item{seed}{Integer; random number generator seed.}
}
\value{
An updated \code{POLYspace} object whose \code{results} slot contains
enrichment statistics.

The \code{results} slot is a list in which each element corresponds to a
sample, and each sub-element corresponds to a target neighborhood shape.
Each sub-element is a \code{data.table} summarizing enrichment results.

When \code{region = TRUE}, the result table includes the following columns:
\itemize{
\item \code{pvalue}: permutation-based p-value;
\item \code{p.adjusted}: multiple-testing adjusted p-value;
\item \code{enrichment}: enrichment score (z-score);
\item \code{neighborhood}: canonical neighborhood identifier including region information;
\item \code{celltype}: neighborhood identifier excluding region information;
\item \code{region}: neighborhood region composition;
\item \code{composition}: neighborhood cellular composition;
\item \code{target}: numeric target neighborhood ID corresponding to the
position of the target in the \code{targets} slot;
\item \code{sample_id}: sample identifier.
}

When \code{region = FALSE}, the result table includes:
\itemize{
\item \code{pvalue}: permutation-based p-value;
\item \code{p.adjusted}: multiple-testing adjusted p-value;
\item \code{enrichment}: enrichment score (z-score);
\item \code{neighborhood}: neighborhood identifier;
\item \code{composition}: neighborhood cellular composition;
\item \code{target}: numeric target neighborhood ID corresponding to the
position of the target in the \code{targets} slot;
\item \code{sample_id}: sample identifier.
}
}
\description{
Performs enrichment analysis of the neighborhoods.
}
