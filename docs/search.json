[{"path":"https://HuiminWang1.github.io/POLYspace/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 Huimin Wang Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/about.html","id":null,"dir":"","previous_headings":"","what":"About","title":"About","text":"developed POLYspace, scalable broadly applicable method identifying analyzing cellular neighborhoods spatial sequencing data. POLYspace efficiently detects neighborhoods arbitrary topology explicitly accounting spatial domains. can applied single sample identify enriched depleted neighborhoods, across multiple samples uncover neighborhoods associated specific phenotypes. applied POLYspace four datasets, including one generated -house, benchmarked existing neighborhood inference methods. POLYspace revealed novel biologically meaningful neighborhoods missed approaches, leads improved prediction sample phenotypes. Together, results demonstrate POLYspace provides powerful framework disentangling complex multicellular interactions spatial sequencing data.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/about.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"About","text":"R version ≥ 4.1.0 Required R packages: combinat, data.table, igraph, limma, methods, parallel, partitions, RCDT, reshape2, stats, utils","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/about.html","id":"issues","dir":"","previous_headings":"","what":"Issues","title":"About","text":"feedback, bug reports, suggestions welcome. reporting issue, please include detailed, reproducible example output sessionInfo() R.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/about.html","id":"entering-polyspace","dir":"","previous_headings":"","what":"Entering POLYspace","title":"About","text":"Details Tutorial","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/articles/multi_sample_human_melanoma.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Multi-sample analysis of human melanoma data","text":"tutorial provides example using POLYspace human melanoma data Hoch et al., 2022 analyze compare multiple spatial sequencing samples. running tutorial, please make sure POLYspace package installed. human melanoma spatial sequencing data used tutorial included package can loaded directly using: storage contains following elements: samples: list containing required input sample, including cellular features spatial coordinates, serves primary input downstream analyses. sample_id: unique identifier spatial sample, used distinguish different slides multi-sample analyses. group: Sample-level grouping information indicating immune infiltration status, used comparative analyses across conditions. subject_id: identifier patient sample obtained, allowing multiple samples individual linked. des: experimental design matrix specifying relationships among samples, groups, subjects regression analyses comparing cellular neighborhoods across multiple slides. coef: name(s) model coefficient(s) defining contrast(s) interest multi-sample regression analyses.","code":"library(POLYspace) data(dataset_melanoma) names(dataset_melanoma) #> [1] \"samples\"    \"sample_id\"  \"group\"      \"subject_id\" \"des\"        #> [6] \"coef\" samples = dataset_cortex$samples sample_id = dataset_cortex$sample_id"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/multi_sample_human_melanoma.html","id":"create-a-polyspace-object","dir":"Articles","previous_headings":"Introduction","what":"Create a POLYspace object","title":"Multi-sample analysis of human melanoma data","text":"dataset contains large number samples, recommend combining samples single POLYspace object. Instead, suggest constructing one POLYspace object per sample, allows enrichment analyses parallelized across samples. strategy enables efficient use computational resources substantially improves overall analysis performance. illustrate analysis pipeline single sample, input construction enrichment analysis, following workflow used mouse cortex example. neighborhood annotation, construct consistent set neighborhoods interest across samples taking union neighborhoods target. ensures set neighborhoods considered samples. union obtained using following code, list annotated objects. enrichment analysis completed samples, resulting objects collected list, denoted . list used input identify differential neighborhoods associated immune infiltration status, controlling subject information. parameter neighborhoods_of_interest specifies set neighborhoods included joint analysis across samples. sample may contain different set neighborhood topologies, parameter controls neighborhoods aligned across samples. \"union\": Uses union neighborhood types observed across samples. option includes neighborhood appears least one sample useful neighborhood composition varies substantially across samples. \"intersect\": Uses neighborhoods shared samples. option restricts analysis common neighborhood types may preferable focusing highly consistent spatial patterns.","code":"# Retrieve the task ID from the SLURM array environment variable taskID = as.integer(Sys.getenv(\"SLURM_ARRAY_TASK_ID\"))  # Create a POLYspace object for a single sample specified by the task ID obj = createPOLYspaceObject(   samples = samples[taskID],   id_of_samples = sample_id[taskID] )  # Construct the spatial cell–cell neighboring network obj = constructSpatialNetwork(POLYspace = obj)  # Identify spatial neighborhoods based on the constructed network obj = neighborhoodMining(POLYspace = obj)  # Annotate the neighborhoods obj = neighborhoodAnnotation(POLYspace = obj) targets = files[[1]]@targets  neighborhoods_of_interest = lapply(targets, function(to){   unlist(sapply(files,function(ob){     ob@annotations[[1]][match(list(to),ob@targets)]   }))  }) neighborhoods_of_interest = lapply(neighborhoods_of_interest,function(x) base::sort(unique(x))) neighborhoods_of_interest = lapply(neighborhoods_of_interest,function(x) {   x[!grepl(\"other\", x)] })  for(i in 1:length(targets)){   if(!(identical(targets[[i]],'singlet')|identical(targets[[i]],'pair'))){     vec = neighborhoods_of_interest[[i]]     if(!is.null(vec)){       jd_frame = lapply(vec, function(x){       y = stringr::str_split(x,'--')[[1]]       sapply(stringr::str_split(y,'_'), function(z) z[2])       })                 jd = sapply(jd_frame, function(x) {                  length(unique(x)) == length(x)                })              neighborhoods_of_interest[[i]] = vec[jd]      }         } } # Perform neighborhood enrichment analysis using permutation testing obj = neighborhoodEnrichment(POLYspace = obj,                              neighborhoods_of_interest = neighborhoods_of_interest,                              permutation_times = 1000,                              ncores = 50) # Extract the design matrix for comparing immune-hot versus immune-cold samples des = dataset_melanoma[[\"des\"]][[\"hot_vs_cold\"]]  # Extract the coefficient specifying the contrast of interest (hot vs. cold) coef = dataset_melanoma[[\"coef\"]][[\"hot_vs_cold\"]]  # Perform joint enrichment analysis to identify differential neighborhoods # associated with immune infiltration status while controlling for subject effects res = polyEnrichment(   object = files,   neighborhoods_of_interest = \"union\",   des = des,   coef = coef )"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/single_sample_mouse_cortex.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Single-sample analysis of the mouse cortex","text":"tutorial provides example analysis using POLYspace single mouse somatosensory cortex seqFISH+ sample Eng et al., 2019. complete analysis typically takes approximately 2 minutes run. running tutorial, please make sure POLYspace package installed. POLYspace supports single-sample multi-sample analyses 2D 3D spatial data. Input data provided list data tables, table corresponds one sample row represents single cell. data table contain following columns: id: unique identifier cell x: x-coordinate cell y: y-coordinate cell z (optional): z-coordinate cell; column can omitted 2D data celltype: cell type annotation cell region (optional): domain region annotation cell global analysis without domain information desired, region column may omitted. part tissue section annotated, regions outside area interest can assigned dummy label (e.g., \"\"), can later excluded enrichment analysis. support multi-sample analyses ensure cells can unambiguously associated corresponding samples, recommend providing sample_id vector alongside samples list, one--one correspondence entries. allows POLYspace correctly identify track individual samples multi-sample settings. sample_id vector provided, POLYspace automatically generate sample identifiers numbered 1 n, n number input samples. single-slide mouse somatosensory cortex seqFISH+ sample included package can loaded directly using: storage contains two elements: samples: list containing single sample (sample1), stored data.table/data.frame 523 cells (rows) five variables: id, x, y, celltype, region. sample_id: character string specifying unique identifier sample (, \"sample1\"). Although dataset contains single sample, sample_id field still provided maintain consistent data structure multi-sample analyses supported POLYspace.","code":"library(POLYspace) data(dataset_cortex) str(dataset_cortex) #> List of 2 #>  $ samples  :List of 1 #>   ..$ sample1:Classes 'data.table' and 'data.frame': 523 obs. of  5 variables: #>   .. ..$ id      : chr [1:523] \"cell1\" \"cell2\" \"cell3\" \"cell4\" ... #>   .. ..$ x       : num [1:523] 1632 1589 1540 1514 1478 ... #>   .. ..$ y       : num [1:523] -1306 -670 -1186 -710 -764 ... #>   .. ..$ celltype: chr [1:523] \"L2/3 eNeuron\" \"L2/3 eNeuron\" \"L2/3 eNeuron\" \"Lhx6 iNeuron\" ... #>   .. ..$ region  : chr [1:523] \"L2/3\" \"L2/3\" \"L2/3\" \"L2/3\" ... #>   .. ..- attr(*, \".internal.selfref\")=<externalptr>  #>  $ sample_id: chr \"sample1\" samples = dataset_cortex$samples sample_id = dataset_cortex$sample_id"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/single_sample_mouse_cortex.html","id":"create-a-polyspace-object","dir":"Articles","previous_headings":"Introduction","what":"Create a POLYspace object","title":"Single-sample analysis of the mouse cortex","text":"step initializes POLYspace object input data. samples argument provides list per-sample cell-level data tables, id_of_samples specifies corresponding sample identifiers. point, arrived POLYspace.","code":"obj = createPOLYspaceObject(samples = samples,                             id_of_samples = sample_id) #> Welcome to POLYspace! #> ************************************ #>   INPUT INFO: #>     - Number of samples: 1  #>     - ID of samples: sample1  #>     - Number of cells: 523  #> ************************************"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/single_sample_mouse_cortex.html","id":"construct-the-spatial-network","dir":"Articles","previous_headings":"Introduction","what":"Construct the spatial network","title":"Single-sample analysis of the mouse cortex","text":"step constructs spatial neighborhood graph sample POLYspace object. Based spatial coordinates cells, constructSpatialNetwork() defines local cell–cell adjacency relationships, serve foundation subsequent neighborhood, topology, enrichment analyses within POLYspace framework. following arguments control edge-length filtering computation: filtering = TRUE: enables default edge-length filtering constructing spatial network. cutoff = \"default\": applies default filtering criterion, edge-length threshold computed separately sample mean + 2 × standard deviation candidate edge lengths. Users may alternatively provide named numeric vector one cutoff per sample; vector names must match id_of_samples, allowing custom, hypothesis-driven thresholds. ncores = 1: specifies number CPU cores used computation. function supports parallel processing, sample can assigned separate core processed concurrently.","code":"obj = constructSpatialNetwork(POLYspace = obj)"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/single_sample_mouse_cortex.html","id":"neighborhood-mining","dir":"Articles","previous_headings":"Introduction","what":"Neighborhood mining","title":"Single-sample analysis of the mouse cortex","text":"step performs neighborhood mining constructed spatial network. neighborhoodMining() enumerates cellular neighborhood patterns based spatial adjacency structure user-specified neighborhood topologies. targets argument specifies neighborhood patterns queried analyzed. provided list, element defines different type target pattern. default neighborhood topologies include following: \"singlet\": single-cell neighborhoods, capturing local context centered individual cells. \"pair\": two-cell neighborhoods, representing direct cell–cell interactions. matrix(c(0, 1, 0,             1, 0, 1,             0, 1, 0), 3, 3): user-defined higher-order neighborhood pattern encoded adjacency matrix, non-zero entries indicate required spatial adjacency positions pattern. flexible specification allows users analyze simple interactions (singlets pairs) well custom, hypothesis-driven neighborhood topologies.","code":"obj = neighborhoodMining(POLYspace = obj)"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/single_sample_mouse_cortex.html","id":"neighborhood-annotation","dir":"Articles","previous_headings":"Introduction","what":"Neighborhood annotation","title":"Single-sample analysis of the mouse cortex","text":"step annotates neighborhood instances identified neighborhood mining.neighborhoodAnnotation() assigns canonical labels neighborhood. region = TRUE: includes region (domain) information neighborhood annotation. set FALSE, neighborhoods annotated using cell type information . delimiter_node = \"--\": specifies delimiter used separate nodes (cells) within neighborhood label. delimiter_region_celltype = \"_\": specifies delimiter used separate region cell type within node label.","code":"obj = neighborhoodAnnotation(POLYspace = obj)"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/single_sample_mouse_cortex.html","id":"neighborhood-enrichment-analysis","dir":"Articles","previous_headings":"Introduction","what":"Neighborhood enrichment analysis","title":"Single-sample analysis of the mouse cortex","text":"step performs neighborhood enrichment analysis annotated neighborhoods.neighborhoodEnrichment() evaluates whether specific cellular neighborhood patterns statistically enriched depleted compared null distribution generated permutation testing. line shows top-ranked enriched neighborhood patterns sample1 displaying first entries enrichment result table obj@results$enrichment$sample1.","code":"obj = neighborhoodEnrichment(POLYspace = obj,                          neighborhoods_of_interest = 'default',                          permutation_times = 1000) lapply(obj@results$enrichment$sample1, head) #> [[1]] #>    pvalue p.adjusted enrichment      neighborhood       celltype region #>     <num>      <num>      <num>            <char>         <char> <char> #> 1:      0          0   8.397246     L6_L6 eNeuron     L6 eNeuron     L6 #> 2:      0          0   7.754084     L4_L4 eNeuron     L4 eNeuron     L4 #> 3:      0          0   6.963251 L2/3_L2/3 eNeuron   L2/3 eNeuron   L2/3 #> 4:      0          0   5.128082     L5_L5 eNeuron     L5 eNeuron     L5 #> 5:      0          0   3.466093 L1_Adarb2 iNeuron Adarb2 iNeuron     L1 #> 6:      0          0  -5.407192     L5_L4 eNeuron     L4 eNeuron     L5 #>       composition target sample_id #>            <char>  <int>    <char> #> 1:     L6 eNeuron      1   sample1 #> 2:     L4 eNeuron      1   sample1 #> 3:   L2/3 eNeuron      1   sample1 #> 4:     L5 eNeuron      1   sample1 #> 5: Adarb2 iNeuron      1   sample1 #> 6:     L4 eNeuron      1   sample1 #>  #> [[2]] #>    pvalue p.adjusted enrichment                         neighborhood #>     <num>      <num>      <num>                               <char> #> 1:      0          0   9.301464 L1_Adarb2 iNeuron--L2/3_L2/3 eNeuron #> 2:      0          0   9.267728          L1_Adarb2 iNeuron--L2/3_OPC #> 3:      0          0   8.353460      L1_Adarb2 iNeuron--L1_microglia #> 4:      0          0   7.695593       L4_L4 eNeuron--L5_Lhx6 iNeuron #> 5:      0          0   7.255625     L1_Adarb2 iNeuron--L1_astrocytes #> 6:      0          0   7.203667         L6_L6 eNeuron--L6_L6 eNeuron #>                        celltype   region                  composition target #>                          <char>   <char>                       <char>  <int> #> 1: Adarb2 iNeuron--L2/3 eNeuron L1--L2/3 Adarb2 iNeuron--L2/3 eNeuron      2 #> 2:          Adarb2 iNeuron--OPC L1--L2/3          Adarb2 iNeuron--OPC      2 #> 3:    Adarb2 iNeuron--microglia       L1    Adarb2 iNeuron--microglia      2 #> 4:     L4 eNeuron--Lhx6 iNeuron   L4--L5     L4 eNeuron--Lhx6 iNeuron      2 #> 5:   Adarb2 iNeuron--astrocytes       L1   Adarb2 iNeuron--astrocytes      2 #> 6:       L6 eNeuron--L6 eNeuron       L6                   L6 eNeuron      2 #>    sample_id #>       <char> #> 1:   sample1 #> 2:   sample1 #> 3:   sample1 #> 4:   sample1 #> 5:   sample1 #> 6:   sample1 #>  #> [[3]] #>    pvalue p.adjusted enrichment #>     <num>      <num>      <num> #> 1:      0          0   50.08929 #> 2:      0          0   39.15412 #> 3:      0          0   28.91151 #> 4:      0          0   28.91151 #> 5:      0          0   28.75858 #> 6:      0          0   25.03483 #>                                            neighborhood #>                                                  <char> #> 1:       L2/3_L2/3 eNeuron--L1_Adarb2 iNeuron--L2/3_OPC #> 2:           L1_astrocytes--L1_Adarb2 iNeuron--L2/3_OPC #> 3:               L5_astrocytes--L6_Olig--L6_endothelial #> 4:                  L1_Adarb2 iNeuron--L1_mural--L1_OPC #> 5:       L1_Adarb2 iNeuron--L1_microglia--L1_astrocytes #> 6: L1_Adarb2 iNeuron--L2/3_L2/3 eNeuron--L1_endothelial #>                                     celltype   region #>                                       <char>   <char> #> 1:         L2/3 eNeuron--Adarb2 iNeuron--OPC L1--L2/3 #> 2:           OPC--Adarb2 iNeuron--astrocytes L1--L2/3 #> 3:             astrocytes--Olig--endothelial   L5--L6 #> 4:                Adarb2 iNeuron--mural--OPC       L1 #> 5:     Adarb2 iNeuron--microglia--astrocytes       L1 #> 6: Adarb2 iNeuron--L2/3 eNeuron--endothelial L1--L2/3 #>                                  composition target sample_id #>                                       <char>  <int>    <char> #> 1:         Adarb2 iNeuron--L2/3 eNeuron--OPC      3   sample1 #> 2:           Adarb2 iNeuron--astrocytes--OPC      3   sample1 #> 3:             astrocytes--endothelial--Olig      3   sample1 #> 4:                Adarb2 iNeuron--mural--OPC      3   sample1 #> 5:     Adarb2 iNeuron--astrocytes--microglia      3   sample1 #> 6: Adarb2 iNeuron--endothelial--L2/3 eNeuron      3   sample1"},{"path":"https://HuiminWang1.github.io/POLYspace/articles/visualize_cell_neighborhood_glyphs.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualize cell neighborhood glyphs","text":"tutorial provides examples visualizing cell neighborhood glyphs. running tutorial, please make sure POLYspace package installed. Visualization cell neighborhood glyphs without explicit region information:  color:  Visualization cell neighborhood glyphs region information:","code":"library(POLYspace) library(patchwork) #> Warning: package 'patchwork' was built under R version 4.3.3 string_list = c('CD8+ T cell','CD8+ T cell--Tumor','CD8+ T cell--pDC--Tumor') adjmat_list = list('singlet',                    'pair',                    matrix(c(0,1,0,1,0,1,0,1,0),3,3)) celltype_color_plate = c(   \"CD8+ T cell\" = 'black',   \"Tumor\"       = 'black',   \"pDC\"         = 'black' ) pl_list = lapply(1:length(string_list),function(x){      pl = cellNeighborhoodGlyph(string = string_list[x],                              adjmat = adjmat_list[[x]],                              celltype_color_plate = celltype_color_plate,                              node_scale = list(c(0.4,0.2),                                                c(0.2,0.2)),                              xlims = c(-0.8,0.8),                              ylims = c(-1,1))    })   combined = wrap_plots(pl_list, nrow = 1) combined string_list = c('CD8+ T cell','CD8+ T cell--Tumor','CD8+ T cell--pDC--Tumor') adjmat_list = list('singlet',                    'pair',                    matrix(c(0,1,0,1,0,1,0,1,0),3,3)) celltype_color_plate = c(   \"CD8+ T cell\" = \"#F03C3C\",   \"pDC\"         = \"#9F7FDB\",   \"Tumor\"       = \"#5F6FD0\" ) pl_list = lapply(1:length(string_list),function(x){      pl = cellNeighborhoodGlyph(string = string_list[x],                              adjmat = adjmat_list[[x]],                              celltype_color_plate = celltype_color_plate,                              node_scale = list(c(0.4,0.2),                                                c(0.2,0.2)),                              xlims = c(-0.8,0.8),                              ylims = c(-1,1))    })   combined = wrap_plots(pl_list, nrow = 1) combined string_list = c(   \"TME_CD8+ T cell\",   \"TME_CD8+ T cell--Tumor_Tumor\",   \"TME_CD8+ T cell--TME_pDC--Tumor_Tumor\" )  adjmat_list = list('singlet',                    'pair',                    matrix(c(0,1,0,1,0,1,0,1,0),3,3)) celltype_color_plate = c(   \"CD8+ T cell\" = 'black',   \"Tumor\"       = 'black',   \"pDC\"         = 'black' )  region_color_plate = c(   \"Tumor\" = \"#7295D1\",      \"TME\"   =  \"#B0DDD3\"  ) pl_list = lapply(1:length(string_list),function(x){      pl = cellNeighborhoodGlyph(string = string_list[x],                            adjmat = adjmat_list[[x]],                            celltype_color_plate = celltype_color_plate,                            region_color_plate = region_color_plate,                            node_text_size = 5,                             node_scale = list(c(0.4,0.2),                                              c(0.2,0.2)),                            xlims = c(-0.8,0.8),                            ylims = c(0,4))    })   combined = wrap_plots(pl_list, nrow = 1) combined"},{"path":"https://HuiminWang1.github.io/POLYspace/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Huimin Wang. Author, maintainer.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang H (2026). POLYspace: POLYspace reveals domain-specific cellular neighborhoods topology-aware spatial analysis. R package version 0.1.0, https://github.com/HuiminWang1/POLYspace.","code":"@Manual{,   title = {POLYspace: POLYspace reveals domain-specific cellular neighborhoods through topology-aware spatial analysis},   author = {Huimin Wang},   year = {2026},   note = {R package version 0.1.0},   url = {https://github.com/HuiminWang1/POLYspace}, }"},{"path":"https://HuiminWang1.github.io/POLYspace/experiments.html","id":null,"dir":"","previous_headings":"","what":"Experiments","title":"Experiments","text":"Mouse cortex analysis Human melanoma analysis","code":""},{"path":[]},{"path":"https://HuiminWang1.github.io/POLYspace/index.html","id":"revealing-multicellular-neighborhoods-in-domain-specific-contexts","dir":"","previous_headings":"","what":"Revealing multicellular neighborhoods in domain-specific contexts","title":"POLYspace reveals domain-specific cellular neighborhoods through topology-aware spatial analysis","text":"Identifying cellular neighborhoods essential understanding cell–cell interactions spatial context. However, existing approaches often overlook complexity multicellular interactions organization spatial domains. present POLYspace, general efficient framework discovering analyzing cellular neighborhoods arbitrary topology accounting spatial domains. POLYspace formulates neighborhood identification subgraph searching problem leverages C3G, fast graph canonization algorithm developed, achieve scalability. Applied one -house dataset three publicly available datasets spanning diverse platforms tissues, POLYspace uncovers domain-specific cellular neighborhoods captured existing methods. neighborhoods reveal key biological mechanisms improve phenotype prediction.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/installation.html","id":null,"dir":"","previous_headings":"","what":"Installation","title":"Installation","text":"can install released version POLYspace Github following code:","code":"# install.packages(\"remotes\") remotes::install_github(\"HuiminWang1/POLYspace\")  # load the package library(POLYspace)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/POLYspace-class.html","id":null,"dir":"Reference","previous_headings":"","what":"POLYspace S4 class — POLYspace-class","title":"POLYspace S4 class — POLYspace-class","text":"container POLYspace analyses, storing inputs, intermediate objects, analysis results.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/POLYspace-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"POLYspace S4 class — POLYspace-class","text":"samples list; per-sample tables. table typically contains columns id, x, y (optional z 3D samples), celltype, region (may omitted global analysis performed). nets list; spatial adjacency networks sample. targets list; specifications neighborhood topologies used targets neighborhood mining enrichment analyses. neighborhoods list; discovered neighborhoods per sample target. element list corresponds sample; within sample, sub-list element corresponds target, ordering consistent targets slot. annotations list; canonical labels assigned discovered neighborhoods. element list corresponds sample; within sample, sub-list element corresponds target, ordering consistent targets slot. results list; analysis outputs, including per-sample enrichment results group-level differential results. parameters list; run-time parameters analysis options.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/POLYspace-package.html","id":null,"dir":"Reference","previous_headings":"","what":"POLYspace: POLYspace reveals domain-specific cellular neighborhoods through topology-aware spatial analysis — POLYspace-package","title":"POLYspace: POLYspace reveals domain-specific cellular neighborhoods through topology-aware spatial analysis — POLYspace-package","text":"Tools discover analyze cellular neighborhoods arbitrary topology accounting spatial domains.","code":""},{"path":[]},{"path":"https://HuiminWang1.github.io/POLYspace/reference/POLYspace-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"POLYspace: POLYspace reveals domain-specific cellular neighborhoods through topology-aware spatial analysis — POLYspace-package","text":"Maintainer: Huimin Wang huimin.wang@duke.edu","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/autoWindowSize.html","id":null,"dir":"Reference","previous_headings":"","what":"Auto-select a window size from point density — autoWindowSize","title":"Auto-select a window size from point density — autoWindowSize","text":"Chooses square window side length window contains, average, window_mean_points points.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/autoWindowSize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auto-select a window size from point density — autoWindowSize","text":"","code":"autoWindowSize(x, y, window_mean_points = 10000, epsilon = 1)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/autoWindowSize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auto-select a window size from point density — autoWindowSize","text":"x Numeric vector x-coordinates. y Numeric vector y-coordinates. window_mean_points Target mean number points per window (default 10000). epsilon Numeric tolerance solving window size (default 1).","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/autoWindowSize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auto-select a window size from point density — autoWindowSize","text":"single numeric value: window side length.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/cellNeighborhoodGlyph.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a cell neighborhood glyph — cellNeighborhoodGlyph","title":"Construct a cell neighborhood glyph — cellNeighborhoodGlyph","text":"Generate topology-aware glyph visually encodes cell neighborhood combining cell types, regions, adjacency structure compact graphical representation.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/cellNeighborhoodGlyph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a cell neighborhood glyph — cellNeighborhoodGlyph","text":"","code":"cellNeighborhoodGlyph(   string,   adjmat,   delimiter_node = \"--\",   delimiter_region_celltype = \"_\",   region_color_plate = NULL,   celltype_color_plate,   dummy_arc_color = c(dummy = \"gray\"),   arc_position = c(0, 0),   arc_radius = c(1, 0.9),   arc_scale = c(0.7, 1),   arc_angle = c(3 * pi/10, 7 * pi/10),   arc_length_out = 100,   arc_width = 3,   arc_text_color = \"default\",   arc_text_x = c(0.7, 0.7),   arc_text_y = c(0.9, 0.7),   arc_text_size = 4,   arc_text_fontface = \"plain\",   node_scale = list(c(0.4, 0.4), c(0.4, 0.4)),   node_xjust = c(0, 0),   node_yjust = c(1.3, 0.6),   network_edge_color = \"black\",   node_text_size = 3,   node_text_hjust = 0.5,   node_text_vjust = 0.5,   node_text_fontface = \"plain\",   xlims = c(-1, 1),   ylims = c(0, 2) )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/cellNeighborhoodGlyph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a cell neighborhood glyph — cellNeighborhoodGlyph","text":"string character string encoding neighborhood nodes. Nodes separated delimiter_node, node encodes region cell type separated delimiter_region_celltype. adjmat adjacency matrix specifying neighborhood topology nodes. delimiter_node character delimiter used separate nodes string. Default \"--\". delimiter_region_celltype character delimiter used split region cell type within node. Default \"_\". region_color_plate named character vector specifying colors region. celltype_color_plate named character vector specifying colors cell type. dummy_arc_color named character vector specifying color used dummy region arc single region present. case, dummy arc serves placeholder indicate cell types contained within region. Default gray. arc_position numeric vector length 2 specifying (x, y) center glyph. arc_radius numeric vector specifying inner outer arc radii. Default c(1, 0.9). arc_scale numeric vector length 2 specifying x- y-axis scaling factors applied arc geometry. Default c(0.7, 1). arc_angle numeric vector length 2 specifying angular positions (radians) used place region-specific arcs. value corresponds one region. Default c(3*pi/10, 7*pi/10). arc_length_out Integer specifying number points used approximate arc. arc_width Numeric specifying line width arcs. arc_text_color Character specifying text color region labels. Use \"default\" inherit region colors. arc_text_x numeric vector specifying x positions region text labels. arc_text_y numeric vector specifying y positions region text labels. arc_text_size Numeric specifying text size region labels. arc_text_fontface Character specifying font face region labels. node_scale list numeric vectors length 2 specifying x- y-axis scaling factors node placement. list element corresponds one region. node_xjust numeric vector specifying horizontal offsets applied node positions, one per region. node_yjust numeric vector specifying vertical offsets applied node positions, one per region. network_edge_color Character specifying color network edges. node_text_size Numeric specifying text size node labels. node_text_hjust Numeric specifying horizontal justification applied node text labels. node_text_vjust Numeric specifying vertical justification applied node text labels. node_text_fontface Character specifying font face node labels. xlims Numeric vector specifying x-axis limits glyph. ylims Numeric vector specifying y-axis limits glyph.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/cellNeighborhoodGlyph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a cell neighborhood glyph — cellNeighborhoodGlyph","text":"ggplot object representing cell neighborhood glyph.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/cellNeighborhoodGlyph.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Construct a cell neighborhood glyph — cellNeighborhoodGlyph","text":"function integrates node parsing, topology encoding, geometric layout construct compact glyph representation cell neighborhood. intended summarizing local spatial structures rather precise spatial coordinates.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/constructSpatialNetwork.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct spatial networks — constructSpatialNetwork","title":"Construct spatial networks — constructSpatialNetwork","text":"Builds spatial networks POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/constructSpatialNetwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct spatial networks — constructSpatialNetwork","text":"","code":"constructSpatialNetwork(   POLYspace,   filtering = TRUE,   cutoff = \"default\",   ncores = 1,   mc.preschedule = TRUE )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/constructSpatialNetwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct spatial networks — constructSpatialNetwork","text":"POLYspace POLYspace object. filtering Logical; TRUE, apply edge filtering remove edges longer specified cutoff. cutoff Either \"default\" (per-sample mean edge length + 2 × SD), named numeric vector per-sample thresholds (names corresponding sample IDs). parameter used filtering = TRUE. ncores Integer; number CPU cores used parallel computation. Samples distributed across cores sample-wise manner (one sample per core). mc.preschedule Logical; passed parallel::mclapply() control task scheduling behavior.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/constructSpatialNetwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct spatial networks — constructSpatialNetwork","text":"updated POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/countAnnotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Count annotations for neighborhoods — countAnnotation","title":"Count annotations for neighborhoods — countAnnotation","text":"Summarizes often annotation label appears given neighborhoods interest. Counts transformed log2 (pseudocount 1).","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/countAnnotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count annotations for neighborhoods — countAnnotation","text":"","code":"countAnnotation(neighborhoods_of_interest, annotation)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/countAnnotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count annotations for neighborhoods — countAnnotation","text":"neighborhoods_of_interest vector identifying neighborhoods interest. annotation vector labels.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/countAnnotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count annotations for neighborhoods — countAnnotation","text":"named numeric vector log2-transformed counts per neighborhood interest (pseudocount = 1).","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/createPOLYspaceObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a POLYspace object — createPOLYspaceObject","title":"Create a POLYspace object — createPOLYspaceObject","text":"Constructs POLYspace container input samples.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/createPOLYspaceObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a POLYspace object — createPOLYspaceObject","text":"","code":"createPOLYspaceObject(samples, id_of_samples = NULL)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/createPOLYspaceObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a POLYspace object — createPOLYspaceObject","text":"samples list per-sample tables. table typically contains columns id, x, y (optional z), celltype, optionally region region information available. id_of_samples Optional character vector sample IDs. NULL, sample IDs automatically generated \"1\", \"2\", \"3\", ...","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/createPOLYspaceObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a POLYspace object — createPOLYspaceObject","text":"POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_cortex.html","id":null,"dir":"Reference","previous_headings":"","what":"Mouse somatosensory cortex seqFISH+ dataset — dataset_cortex","title":"Mouse somatosensory cortex seqFISH+ dataset — dataset_cortex","text":"processed spatial dataset single seqFISH+ slide mouse somatosensory cortex.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_cortex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mouse somatosensory cortex seqFISH+ dataset — dataset_cortex","text":"","code":"dataset_cortex"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_cortex.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mouse somatosensory cortex seqFISH+ dataset — dataset_cortex","text":"list following structure: samples named list samples. sample contains data.table : id Cell identifier. x x-coordinate cell. y y-coordinate cell. celltype Cell type annotation. region Region annotation. sample_id character vector sample identifiers.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_cortex.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mouse somatosensory cortex seqFISH+ dataset — dataset_cortex","text":"Eng, C.-H. L. et al. Transcriptome-scale super-resolved imaging tissues rna seqfish+. Nature 568, 235–239 (2019).460","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_diabetes.html","id":null,"dir":"Reference","previous_headings":"","what":"Human type 1 diabetes imaging mass cytometry dataset — dataset_diabetes","title":"Human type 1 diabetes imaging mass cytometry dataset — dataset_diabetes","text":"processed spatial dataset human type 1 diabetes imaging mass cytometry (IMC).","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_diabetes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Human type 1 diabetes imaging mass cytometry dataset — dataset_diabetes","text":"","code":"dataset_diabetes"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_diabetes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Human type 1 diabetes imaging mass cytometry dataset — dataset_diabetes","text":"list following structure: samples named list samples. sample contains data.table : id Cell identifier. x x-coordinate cell. y y-coordinate cell. celltype Cell type annotation. region Region annotation. sample_id character vector sample identifiers. group character vector indicating disease-related stratification. subject_id character vector subject identifiers. des list containing design matrix specifying variables used regression analyses. coef list containing regression coefficients corresponding variables tested model.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_diabetes.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Human type 1 diabetes imaging mass cytometry dataset — dataset_diabetes","text":"Damond, N. et al. map human type 1 diabetes progression imaging mass cytometry. Cell metabolism 29, 755–768526 (2019).527","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_melanoma.html","id":null,"dir":"Reference","previous_headings":"","what":"Human melanoma imaging mass cytometry dataset — dataset_melanoma","title":"Human melanoma imaging mass cytometry dataset — dataset_melanoma","text":"processed spatial dataset human melanoma imaging mass cytometry (IMC).","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_melanoma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Human melanoma imaging mass cytometry dataset — dataset_melanoma","text":"","code":"dataset_melanoma"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_melanoma.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Human melanoma imaging mass cytometry dataset — dataset_melanoma","text":"list following structure: samples named list samples. sample contains data.table : id Cell identifier. x x-coordinate cell. y y-coordinate cell. celltype Cell type annotation. region Region annotation. sample_id character vector sample identifiers. group factor character vector indicating immune infiltration degree. subject_id character vector subject identifiers. des list containing design matrix specifying variables used regression analyses. coef list containing regression coefficients corresponding variables tested model.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/dataset_melanoma.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Human melanoma imaging mass cytometry dataset — dataset_melanoma","text":"Hoch, T. et al. Multiplexed imaging mass cytometry chemokine milieus melanoma characterizes features the477 response immunotherapy. Sci. immunology 7, eabk1692 (2022).478","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/findUniqueComposition.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify neighborhoods with unique compositions — findUniqueComposition","title":"Identify neighborhoods with unique compositions — findUniqueComposition","text":"Drops duplicates composition returns unique neighborhoods.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/findUniqueComposition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify neighborhoods with unique compositions — findUniqueComposition","text":"","code":"findUniqueComposition(neighborhood, delimiter_node = \"--\")"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/findUniqueComposition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify neighborhoods with unique compositions — findUniqueComposition","text":"neighborhood list neighborhoods. delimiter_node string used join nodes. Default \"–\".","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/findUniqueComposition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify neighborhoods with unique compositions — findUniqueComposition","text":"list neighborhoods unique compositions.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateArcData.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate arc geometry for a neighborhood glyph — generateArcData","title":"Generate arc geometry for a neighborhood glyph — generateArcData","text":"Compute arc-level geometry used render region- cell-type–specific arcs cell neighborhood glyph.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateArcData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate arc geometry for a neighborhood glyph — generateArcData","text":"","code":"generateArcData(   node_data,   arc_center,   arc_radius = c(1, 0.9),   arc_scale = c(0.7, 1),   arc_angle = c(3 * pi/10, 7 * pi/10),   arc_length_out = 100 )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateArcData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate arc geometry for a neighborhood glyph — generateArcData","text":"node_data data.frame node-level information, typically generated generateNodeData(). arc_center numeric vector length 2 specifying (x, y) center glyph. arc_radius numeric vector specifying outer inner arc radii. Default c(1, 0.9). arc_scale numeric vector length 2 specifying anisotropic scaling factors applied arc geometry x y directions. first value corresponds x-axis scale, second y-axis scale. Default c(0.7, 1). arc_angle numeric vector length 2 specifying start end angles (radians) arc. Default c(3*pi/10, 7*pi/10). arc_length_out Integer specifying number points used approximate arc.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateArcData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate arc geometry for a neighborhood glyph — generateArcData","text":"list containing arc geometry.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateEdgeData.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate edge data from a neighborhood topology — generateEdgeData","title":"Generate edge data from a neighborhood topology — generateEdgeData","text":"Convert different representations cell neighborhood topology (singlet, pair, adjacency matrix) edge data.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateEdgeData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate edge data from a neighborhood topology — generateEdgeData","text":"","code":"generateEdgeData(ta)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateEdgeData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate edge data from a neighborhood topology — generateEdgeData","text":"ta Neighborhood topology input.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateEdgeData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate edge data from a neighborhood topology — generateEdgeData","text":"data.frame columns .","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateIsomorphismAgent.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate the isomorphism agent for a target — generateIsomorphismAgent","title":"Generate the isomorphism agent for a target — generateIsomorphismAgent","text":"Builds isomorphism mappings target defined adjacency matrix.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateIsomorphismAgent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate the isomorphism agent for a target — generateIsomorphismAgent","text":"","code":"generateIsomorphismAgent(target, delimiter_node = \"--\")"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateIsomorphismAgent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate the isomorphism agent for a target — generateIsomorphismAgent","text":"target adjacency matrix defining target. delimiter_node character string used join node labels. Default \"–\".","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateIsomorphismAgent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate the isomorphism agent for a target — generateIsomorphismAgent","text":"data.table containing isomorphism mappings target.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodePosition.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate node positions for a neighborhood glyph — generateNodePosition","title":"Generate node positions for a neighborhood glyph — generateNodePosition","text":"Compute node-level (x, y) positions placing nodes relative region-specific arcs cell neighborhood glyph.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodePosition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate node positions for a neighborhood glyph — generateNodePosition","text":"","code":"generateNodePosition(   node_data,   arc_center,   node_scale = list(c(0.4, 0.4), c(0.4, 0.4)),   node_xjust = c(0, 0),   node_yjust = c(2.5, -0.4) )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodePosition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate node positions for a neighborhood glyph — generateNodePosition","text":"node_data data.frame containing node-level information, produced generateNodeData(). arc_center numeric vector length 2 specifying (x, y) center glyph. node_scale list numeric vectors length 2 specifying x- y-axis scaling factors node placement. element list corresponds one region. Default list(c(0.4, 0.4), c(0.4, 0.4)). node_xjust numeric vector specifying horizontal justification offsets applied node positions. value corresponds one region. Default c(0, 0). node_yjust numeric vector specifying vertical justification offsets applied node positions. value corresponds one region. Default c(2.5, -0.4).","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodePosition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate node positions for a neighborhood glyph — generateNodePosition","text":"data.frame containing node coordinates associated node attributes.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodedata.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate node data from a neighborhood string — generateNodedata","title":"Generate node data from a neighborhood string — generateNodedata","text":"Parse neighborhood-encoded string node-level data, separating nodes extracting region cell type information.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodedata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate node data from a neighborhood string — generateNodedata","text":"","code":"generateNodedata(   string,   delimiter_node = \"--\",   delimiter_region_celltype = \"_\" )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodedata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate node data from a neighborhood string — generateNodedata","text":"string character string encoding neighborhood nodes. Nodes separated delimiter_node, node encodes region cell type separated delimiter_region_celltype. delimiter_node character delimiter used separate nodes. Default \"--\". delimiter_region_celltype character delimiter used split region cell type within node. Default \"_\".","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateNodedata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate node data from a neighborhood string — generateNodedata","text":"data.frame containing node-level information, node id, region, cell type.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateWindows.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate sliding windows — generateWindows","title":"Generate sliding windows — generateWindows","text":"Creates sliding windows spatial area, optionally choosing window size automatically point density.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateWindows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate sliding windows — generateWindows","text":"","code":"generateWindows(   sa,   ne,   id,   ms,   window_size = \"auto\",   window_mean_points = 10000,   epsilon = 1 )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateWindows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate sliding windows — generateWindows","text":"sa spatial sample table coordinates. ne spatial network sample. id sample ID. ms Size target. window_size Numeric side length, \"auto\" infer density. window_mean_points Target mean points per window window_size=\"auto\". epsilon Tolerance used solving auto window size.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/generateWindows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate sliding windows — generateWindows","text":"list windows window size.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/isomorphismMapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the canonical label for each neighborhood — isomorphismMapping","title":"Get the canonical label for each neighborhood — isomorphismMapping","text":"Computes canonical label neighborhood.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/isomorphismMapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the canonical label for each neighborhood — isomorphismMapping","text":"","code":"isomorphismMapping(subs, ta, ag, delimiter_node = \"--\", noi = NULL, coi = NULL)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/isomorphismMapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the canonical label for each neighborhood — isomorphismMapping","text":"subs Neighborhoods identified POLYspace. ta shape neighborhoods. ag isomorphism mappings. delimiter_node delimiter used constructing labels. Default \"--\". noi Neighborhoods interest. coi Compositions interest.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/isomorphismMapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the canonical label for each neighborhood — isomorphismMapping","text":"Annotations neighborhood.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodAnnotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate neighborhoods — neighborhoodAnnotation","title":"Annotate neighborhoods — neighborhoodAnnotation","text":"Adds annotations neighborhoods POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodAnnotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate neighborhoods — neighborhoodAnnotation","text":"","code":"neighborhoodAnnotation(   POLYspace,   region = TRUE,   delimiter_node = \"--\",   delimiter_region_celltype = \"_\",   ncores = 1,   mc.preschedule = TRUE )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodAnnotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate neighborhoods — neighborhoodAnnotation","text":"POLYspace POLYspace object. region Logical; whether include region-level information performing canonical neighborhood annotation. delimiter_node Character; delimiter used node labels annotation (default \"--\"). delimiter_region_celltype Character; delimiter used region cell type annotation (default \"_\"). ncores Integer; number CPU cores use. particularly useful targets complex singlet multiple samples included POLYspace object. case, computations distributed across cores combinations samples targets. mc.preschedule Logical; passed parallel::mclapply().","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodAnnotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate neighborhoods — neighborhoodAnnotation","text":"updated POLYspace object neighborhood annotations. element list corresponds sample; within sample, sub-list element corresponds target, ordering consistent targets slot.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Neighborhood enrichment analysis — neighborhoodEnrichment","title":"Neighborhood enrichment analysis — neighborhoodEnrichment","text":"Performs enrichment analysis neighborhoods.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Neighborhood enrichment analysis — neighborhoodEnrichment","text":"","code":"neighborhoodEnrichment(   POLYspace,   region = TRUE,   delimiter_node = \"--\",   delimiter_region_celltype = \"_\",   neighborhoods_of_interest = \"default\",   permutation_times = 100,   p_adjust_method = \"fdr\",   ncores = 1,   mc.preschedule = TRUE,   set_seed = TRUE,   seed = 123 )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Neighborhood enrichment analysis — neighborhoodEnrichment","text":"POLYspace POLYspace object. region Logical; whether include region-level information performing canonical neighborhood annotation. option effective region information included previous annotation step. delimiter_node Character; delimiter used node labels annotation (default \"--\"). delimiter_region_celltype Character; delimiter used region cell type annotation (default \"_\"). neighborhoods_of_interest Neighborhoods tested enrichment. can specified : \"default\": complex neighborhood shapes (beyond pairs), neighborhoods distinct node types considered; \"full\": neighborhood types detected sample included; user-defined list: list whose elements correspond targets, element specifies neighborhoods interest target. permutation_times Integer; number permutations used enrichment analysis (default 100). p_adjust_method Character; method used multiple testing correction permutation-based tests (e.g., \"fdr\"). ncores Integer; number CPU cores use. primarily used permutation-based enrichment, computations distributed across combinations samples targets, permutation assigned core. mc.preschedule Logical; passed parallel::mclapply(). set_seed Logical; TRUE, set random number generator seed seed reproducibility. seed Integer; random number generator seed.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodEnrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Neighborhood enrichment analysis — neighborhoodEnrichment","text":"updated POLYspace object whose results slot contains enrichment statistics. results slot list element corresponds sample, sub-element corresponds target neighborhood shape. sub-element data.table summarizing enrichment results. region = TRUE, result table includes following columns: pvalue: permutation-based p-value; p.adjusted: multiple-testing adjusted p-value; enrichment: enrichment score (z-score); neighborhood: canonical neighborhood identifier including region information; celltype: neighborhood identifier excluding region information; region: neighborhood region composition; composition: neighborhood cellular composition; target: numeric target neighborhood ID corresponding position target targets slot; sample_id: sample identifier. region = FALSE, result table includes: pvalue: permutation-based p-value; p.adjusted: multiple-testing adjusted p-value; enrichment: enrichment score (z-score); neighborhood: neighborhood identifier; composition: neighborhood cellular composition; target: numeric target neighborhood ID corresponding position target targets slot; sample_id: sample identifier.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodMining.html","id":null,"dir":"Reference","previous_headings":"","what":"Mine neighborhoods — neighborhoodMining","title":"Mine neighborhoods — neighborhoodMining","text":"Finds specified neighborhoods POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodMining.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mine neighborhoods — neighborhoodMining","text":"","code":"neighborhoodMining(   POLYspace,   targets = list(\"singlet\", \"pair\", matrix(c(0, 1, 0, 1, 0, 1, 0, 1, 0), 3, 3)),   ncores = 1,   mc.preschedule = TRUE )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodMining.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mine neighborhoods — neighborhoodMining","text":"POLYspace POLYspace object. targets list specifying neighborhood shapes interest, \"singlet\", \"pair\", custom adjacency matrix. default, targets include singlet, pair, triple-chain neighborhoods. ncores Integer; number CPU cores use. particularly useful targets complex singlet pair multiple samples included POLYspace object. case, computations distributed across cores combinations samples targets mc.preschedule Logical; passed parallel::mclapply().","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodMining.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mine neighborhoods — neighborhoodMining","text":"updated POLYspace object whose neighborhoods slot includes discovered neighborhoods. element list corresponds sample; within sample, sub-list element corresponds target, ordering consistent targets slot.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodWindowMining.html","id":null,"dir":"Reference","previous_headings":"","what":"Windowed neighborhood mining — neighborhoodWindowMining","title":"Windowed neighborhood mining — neighborhoodWindowMining","text":"Mines specified neighborhood targets using sliding windows POLYspace object containing slides large numbers cells.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodWindowMining.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Windowed neighborhood mining — neighborhoodWindowMining","text":"","code":"neighborhoodWindowMining(   POLYspace,   targets = list(\"singlet\", \"pair\", matrix(c(0, 1, 0, 1, 0, 1, 0, 1, 0), 3, 3)),   window_size = \"auto\",   window_mean_points = 10000,   epsilon = 1,   ncores = 1,   mc.preschedule = TRUE )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodWindowMining.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Windowed neighborhood mining — neighborhoodWindowMining","text":"POLYspace POLYspace object. targets list specifying neighborhood shapes interest, \"singlet\", \"pair\", custom adjacency matrix. default, targets include singlet, pair, triple-chain neighborhoods. window_size Numeric; side length square window, \"auto\" infer window size based cell density. window_mean_points Numeric; target mean number cells per window window_size = \"auto\" used infer window size. epsilon Numeric; tolerance parameter used automatic window size inference. ncores Integer; number CPU cores use. particularly useful targets complex singlet pair multiple samples included POLYspace object. case, computations distributed across cores combinations samples, targets, windows. mc.preschedule Logical; passed parallel::mclapply().","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/neighborhoodWindowMining.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Windowed neighborhood mining — neighborhoodWindowMining","text":"updated POLYspace object whose neighborhoods slot includes windowed target discoveries. element list corresponds sample; within sample, sub-list element corresponds target, ordering consistent targets slot.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/polyEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Differential neighborhoods across samples — polyEnrichment","title":"Differential neighborhoods across samples — polyEnrichment","text":"Performs differential enrichment analysis neighborhoods across samples.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/polyEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differential neighborhoods across samples — polyEnrichment","text":"","code":"polyEnrichment(   object,   region = TRUE,   targets = \"default\",   neighborhoods_of_interest = c(\"union\", \"intersect\"),   des,   coef,   p_adjust_method = \"fdr\",   return_object = FALSE )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/polyEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differential neighborhoods across samples — polyEnrichment","text":"object POLYspace object list POLYspace objects. region Logical; whether use region-level neighborhoods constructing feature matrix, determines level enrichment analysis include. targets Targets include. \"default\" uses union targets across input objects. neighborhoods_of_interest Neighborhoods include feature matrix. can specified : \"union\": neighborhood shape, use union neighborhoods observed across samples; \"intersect\": neighborhood shape, use neighborhoods shared samples; user-defined list: list whose elements correspond targets, element specifies neighborhoods interest target. des Design matrix specifying experimental design. coef Coefficient name index des tested. p_adjust_method Character; method p-value adjustment (e.g., \"fdr\"). return_object Logical; TRUE, return updated POLYspace object instead result table.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/polyEnrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Differential neighborhoods across samples — polyEnrichment","text":"return_object = TRUE, updated POLYspace object differential result listattached; otherwise, list differential results. Within list, contains following components: results: differential neighborhood results, ordering consistent targets list; targets: targets used analysis; des: design matrix used differential testing; coef: coefficient tested design matrix.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveFeatureMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve neighborhood feature matrices — retrieveFeatureMatrix","title":"Retrieve neighborhood feature matrices — retrieveFeatureMatrix","text":"Retrieves neighborhood-level feature matrices related information POLYspace object list POLYspace objects.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveFeatureMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve neighborhood feature matrices — retrieveFeatureMatrix","text":"","code":"retrieveFeatureMatrix(   object,   region = TRUE,   targets = \"default\",   neighborhoods_of_interest = c(\"union\", \"intersect\") )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveFeatureMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve neighborhood feature matrices — retrieveFeatureMatrix","text":"object POLYspace object list POLYspace objects. region Logical; whether use region-level neighborhoods constructing feature matrix, determines level enrichment analysis include. targets Targets include. \"default\" uses union targets across input objects. neighborhoods_of_interest Neighborhoods include feature matrix. can specified : \"union\": neighborhood shape, use union neighborhoods observed across samples; \"intersect\": neighborhood shape, use neighborhoods shared samples; user-defined list: list whose elements correspond targets, element specifies neighborhoods interest target.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveFeatureMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve neighborhood feature matrices — retrieveFeatureMatrix","text":"list containing: matrices: list feature matrices, ordering consistent targets output list. Rows correspond neighborhoods columns correspond sample IDs; neighborhoods_info: metadata describing neighborhoods included matrices, regional cellular composition; targets: targets used feature matrix retrieval.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveSingleResult.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve single-sample enrichment results — retrieveSingleResult","title":"Retrieve single-sample enrichment results — retrieveSingleResult","text":"Extracts per-sample enrichment results POLYspace object list POLYspace objects.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveSingleResult.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve single-sample enrichment results — retrieveSingleResult","text":"","code":"retrieveSingleResult(   object,   targets = \"default\",   neighborhoods_of_interest = c(\"union\", \"intersect\") )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveSingleResult.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve single-sample enrichment results — retrieveSingleResult","text":"object POLYspace object list POLYspace objects. targets Targets include. \"default\" uses union targets across input objects. neighborhoods_of_interest Neighborhoods include feature matrix. can specified : \"union\": neighborhood shape, use union neighborhoods observed across samples; \"intersect\": neighborhood shape, use neighborhoods shared samples; user-defined list: list whose elements correspond targets, element specifies neighborhoods interest target.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/retrieveSingleResult.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve single-sample enrichment results — retrieveSingleResult","text":"list components: results: data.table containing single-sample enrichment results; targets: targets used analysis.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/showWelcomeMessage.html","id":null,"dir":"Reference","previous_headings":"","what":"Show a welcome message — showWelcomeMessage","title":"Show a welcome message — showWelcomeMessage","text":"Prints brief welcome POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/showWelcomeMessage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show a welcome message — showWelcomeMessage","text":"","code":"showWelcomeMessage(POLYspace)"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/showWelcomeMessage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show a welcome message — showWelcomeMessage","text":"POLYspace POLYspace object.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/showWelcomeMessage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show a welcome message — showWelcomeMessage","text":"return value, called side effects.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toCelltypeNeighborhood.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert segments to cell-type neighborhoods — toCelltypeNeighborhood","title":"Convert segments to cell-type neighborhoods — toCelltypeNeighborhood","text":"Builds cell-type–level neighborhood labels segment labels.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toCelltypeNeighborhood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert segments to cell-type neighborhoods — toCelltypeNeighborhood","text":"","code":"toCelltypeNeighborhood(   segments,   delimiter_node = \"--\",   delimiter_region_celltype = \"_\",   ta,   ag )"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toCelltypeNeighborhood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert segments to cell-type neighborhoods — toCelltypeNeighborhood","text":"segments Segment labels. delimiter_node Delimiter node labels (default \"–\"). delimiter_region_celltype Delimiter region cell type (default \"_\"). ta Target specification used define neighborhood shape. ag Isomorphism agent canonicalize neighborhood labels.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toCelltypeNeighborhood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert segments to cell-type neighborhoods — toCelltypeNeighborhood","text":"string cell-type neighborhood labels.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toComposition.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert segments to corresponding compositions — toComposition","title":"Convert segments to corresponding compositions — toComposition","text":"Collapses segment labels composition string.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toComposition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert segments to corresponding compositions — toComposition","text":"","code":"toComposition(segments, delimiter_node = \"--\")"},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toComposition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert segments to corresponding compositions — toComposition","text":"segments Segment labels. delimiter_node Delimiter used join labels (default \"--\").","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/reference/toComposition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert segments to corresponding compositions — toComposition","text":"string corresponding compositions.","code":""},{"path":"https://HuiminWang1.github.io/POLYspace/visualizations.html","id":null,"dir":"","previous_headings":"","what":"Visualizations","title":"Visualizations","text":"Visualize cell neighborhood glyphs","code":""}]
